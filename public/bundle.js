(()=>{function R([t,e,n,o]){return`rgba(${t*255},${e*255},${n*255},${o})`}function y(t,e,n=1){return t.map((o,r)=>o+e[r]*n)}function se(t,e=1){return t.map((n,o)=>n*e)}function lt(t,e){return y(t,e,-1)}function en(t){return t.reduce((e,n)=>e+n*n,0)**.5}function pt(t,e){return en(lt(e,t))}var St=2**31,m=nn(123);function nn(t=0){0<t&&t<1&&(t=~~(t*St));let e=n=>(t=t*16807%2147483647)%n;return m=n=>n==-1?t:n==null?e(St)/St:e(n),m}function N(t,e=m){if(!t)return null;let n=e(t.length);return t[n]}function ct(t,e=m){let n=Tt(t),o=e()*n-t[0],r=0;for(;o>=0;)o-=t[++r];return r}function le(t,e,n=m){let o=t.map(e),r=ct(o);return t[r]}function F(t,e=o=>o,n=m){let o=ct(Object.values(t).map(e),n);return Object.keys(t)[o]}function Tt(t){return t.reduce((e,n)=>e- -n,0)}function W(t=m){let e="";for(let n=0;n<t(3)+2;n++)e+=N([..."kstnhmyrw",""],t)+N([..."aiueo",""],t);return on(e)}function on(t){return t?t[0].toUpperCase()+t.substring(1):""}function q(t){for(let e of Object.values(t))for(let n in e){let o=Number(e[n]);!isNaN(o)&&n!="colors"&&(e[n]=o)}return t}function pe(t,e=m){return t=t*100,t=(t%1>e()?1:0)+~~t,t/=100}var E=q(Object.fromEntries(`Health:So called Hit Points:31
Strength:Dealing Damage:fg
Resilience:Damage reduction:qp
Greed:Find More:c4
Bloom:Regeneration:ba
Courage:Cover your allies:21
Anger:Avenge Damage:uv
Mercy:Heal Friends:lx
Knowledge:Writing and Reading:mn
Light:Strike True:je
Dark:Avoid Damage:o8
Time:Attack Rate:lm
Purity:Resist Poison:rq
Venom:Poison:ba`.split(`
`).map((t,e)=>{let[n,o,r]=t.split(":"),s=n[0];return[s,{l:s,name:n,tip:o,colors:r,ind:e}]}))),L=q(Object.fromEntries(`Wooden:67:H:10
Iron:32:S:10
Stone:mn:R:10
Golden:c4:G:2
Plant:ba:B:5
Leather:56:C:5
Bone:ji:A:5
Cloth:tv:M:10
Paper:kl:K:5
Glass:wr:L:5
Obsidian:no:D:2
Copper:ef:T:5
Silver:lx:P:3
Asbestos:kb:V:1`.split(`
`).map(t=>{let[e,n,o,r]=t.split(":");return[e,{colors:n,aspects:ut(o),chance:r}]}))),$=q(Object.fromEntries(`Door:2:10:Wooden:0:1:
Bed:2:H:Wooden:10:.5
Column:3:R:Stone:0:1:
Apple:1:B:Plant:10:1:
Chair:2:H:Wooden:10:1:
Chest:1:G:Wooden:10:1:
Shelf:2:G:Wooden:0:1:
Stand:2::Stone:0:1:
Display:2::Glass:0:1:
Plaque:2::Iron:0:1:
Big Table:2:R:Stone:0:1:
Display:2::Glass:0:1:
Dial:2::Glass:0:1:
Table:2::Wooden:10:.5:
Clock:1:T:Golden:1:1:
Pedestal:1::Wooden::1:
Mirror:2::Glass:5:1:
Angel:2:P:Silver:3:1:
Press:2::Iron:0:1:
Brush:2::Cloth:0:1:
Wine:1:A:Plant:5:1:`.split(`
`).map((t,e)=>{let[n,o,r,s,i,x]=t.split(":");return[n,{name:n,scale:o,aspects:ut(r),material:s,chance:i,ind:e,placeh:x}]}))),mt=q(Object.fromEntries(`Human:G
Elf:B
Cat:D
Ogre:M
Fairy
Bird
Rat
Raven
Skel
Imp
Dog
Hippo
Lizard
Drago
Alien
Hare`.split(`
`).map((t,e)=>{let[n,o]=t.split(":");return[n,{name:n,aspects:ut(o),ind:e,chance:1/(10+e)}]}))),ce={...mt,...$};function ut(t=""){let e={};return[...t].forEach(n=>e[n]=(e[n]||0)+1),e}function Ct(t,e,n=1){let o={};t??={},e??={};for(let r in{...t,...e})o[r]=(t[r]||0)+(e[r]||0)*n;return o}function me(t){let e="";for(let n of Object.keys(E).sort((o,r)=>t[o]-t[r]))t[n]>0&&(e+=`<div class="aspect" data-aspect=${n}><span class=num>${t[n].toFixed(2).replace(/(.00)/g,"")}<span> ${E[n].name}</div>`);return e}function Pt(t){return Tt(Object.values(t))}var T=64,Y=5,d=3,c=128,u=256,M=8,At=Y*d,S=[...new Array(At)].map((t,e)=>({id:e})),Dt=0;function wt(t){return t&&{...ue(t),chest:wt(t.chest),held:t.held?.map(e=>wt(e))}}var rn="id,name,kind,pos,scale,right,shape,colors,aspects,type,material,explored,level,dream,combat".split(",");function ue(t){return Object.fromEntries(rn.map(e=>[e,t[e]]))}function Lt(t){if(!t)return null;let e=b({...ye[t.kind],...ue(t),chest:Lt(t.chest)});return t.held?.forEach(n=>{V(e,Lt(n),n.pos)}),e}function fe(){return{cur:a.id,lid:Dt,rooms:S,all:Object.values(g).filter(t=>!t.parent&&t.kind!=4).map(t=>wt(t))}}function de(t){Object.values(g).forEach(e=>B(e)),t.all.forEach(e=>Lt(e)),_(g[t.cur]),Dt=t.lid,S=t.rooms;for(let e of S)e.dream&&(ft(e.id,!0),Q(e.id))}function be(){return++Dt}var Mt=(t,e,n)=>an(pn(n,t),e),Z=(t,e)=>Mt("S",t,e),ge=(t,e)=>Mt("T",t,e),I=(t,e)=>Mt("O",t,e);function an(t,e){if(!t)debugger;if(!e)return t;let n=t.cloneNode();return f(n).filter=cn(e),f(n).drawImage(t,0,0),n}var J=32,sn=48,ln=64;var Ht=112;var dt=144,he=ln,Ee=sn,xe=16;function pn(t,e,n=0){e=="O"&&(n=1);let o=Rt(M+n*2);return o.id=e+t,f(o).filter=`url(#_${e})`,f(o).drawImage(img,t%xe*M,~~(t/xe)*M,M,M,n,n,M,M),o}function f(t){return t.getContext("2d")}function cn(t){if(!$t.has(t)){$t.add(t);let[e,n]=[...t].map(r=>w[Number.parseInt(r,36)]),o=`<filter id=f${t}><feColorMatrix type=matrix values="${e[0]} ${n[0]} 0 0 0  ${e[1]} ${n[1]} 0 0 0  ${e[2]} ${n[2]} 0 0 0  0 0 0 1 0" /></filter>`;DEFS.innerHTML+=o}return`url(#f${t})`}function Rt(t,e=t){let n=document.createElement("canvas");return n.classList.add("sprite"),n.width=t,n.height=e,n}var X=t=>f(t).createPattern(t,"repeat");function ve(t,e,n){let o=document.createElement("div");o.classList.add("ftext"),o.classList.add(n),o.innerHTML=`<div>${t}</div>`,Scene.appendChild(o),setTimeout(()=>Scene.removeChild(o),3e3),It(o,e)}function It(t,e,n=""){t.style.left=`${e[0]}px`,t.style.top=`${e[2]}px`,t.style.transform=`translateZ(${e[1]}px) `+n}function U(t,e){let n=f(t);n.fillStyle=e,n.fillRect(0,0,t.width,t.height)}function j(t,e,n,o=1){return t.width=e*o,t.height=n*o,t.style.width=`${e}px`,t.style.height=`${n}px`,t}function Se(t){return[~~(t/d),t%d]}function Te(t){let[e,n]=Se(t),o=tt(`ca${t}`,"carpet",{top:`${++n*c}px`,left:`${e*u}px`},"canvas");return j(o,u,T,2),o}function Ce(t){let[e,n]=Se(t),o=tt(`wp${t}`,"wp",{top:`${n*c}px`,left:`${e*u}px`},"canvas");return j(o,u,c,2),o}function tt(t,e,n,o="canvas"){let r=document.createElement(o);return r.id=t,r.classList.add(...e.split(",")),Object.assign(r.style,n),Scene.appendChild(r),r}function Pe(t,e){let n=t.cloneNode();return n.width*=e,n.height*=e,bt(n,t,0,0,e),n}function bt(t,e,n,o,r){f(t).imageSmoothingEnabled=!1,f(t).drawImage(e,n,o,e.width*r,e.height*r)}function ft(t,e){S[t].dream=e;let n=K(t);for(let o of n)A(o,[]),Bt(o,""),o.dream&&!e&&B(o),!o.dream&&o.kind!=1&&(o.div.style.display=e?"none":"block")}function yt(t){let e=h(t.pos);ft(e,!0);let n=S[e];n.aspects=t.aspects,n.level=t.level,mn(e),un(e),Q(e)}function Xt(t){ft(t,!1)}function mn(t){for(let e=0;e<3;e++)b({...z,level:1,colors:"nm",type:ke(),name:W(),chest:nt(J+2,"lk"),pos:G(t),dream:!0})}function un(t){for(let e of[!0,!1]){let n=Yt(t,e),o=Ft(t);o[0]+=(e?.3:.7)*u,n.forEach((r,s)=>{r.pos=y(o,[0,(s+.5)*T/n.length,0]),r.right=e,r.combat={pos:r.pos,hp:Ot(r),delay:Nt(r),aggro:0},Zt(r),et(r)})}}function Ot(t){return~~((1+ot(t,"H")+t.level*.2)*10)}function Nt(t){return~~(3e3/(1+ot(t,"T")+t.level*.1+m()))}function fn(t){return(1+ot(t,"S")+t.level*.1)*3}function Le(t,e){A(e,Ae(e));let n=~~fn(t);e.combat.hp-=n,ve(`${n}`,y(e.pos,[-5+m(10),0,-35]),"red"),Zt(e)}function Q(t){if(!S[t].dream)return;let e=Yt(t).filter(i=>i.combat.hp>0),n=Math.min(...e.map(i=>i.combat.delay)),o=()=>{for(let i of e)i.combat.delay-=n},r=e.find(i=>i.combat.delay==n);if(!r)return we(t);let s=le(e,i=>i.dream==r.dream?0:1+ot(i,"C"));if(!s)return we(t);A(r,De(r,s,o))}function we(t){Xt(t)}var dn="scaleX(-1) translateX(-100%)";var z={bitPos:[[3,1],[2,14],[2,10],[2,13]],mountPoint:[0,0,16],size:[16,24],origin:"75% 50%",kind:1,makeBits:t=>[[t.shape,t.colors],[he,t.colors],xn(t.chest),[Ee,t.colors]]},it={bitPos:[[0,0]],size:[10,10],kind:3,makeBits:t=>t&&[[t.shape,t.colors]]},zt={...it,mountPoint:[5,0,0],kind:2},D={...it,kind:4},ye=[,z,zt,it,D],$e=1,xt=2,jt=3;function O(t,e,n){let o=t.pos,r=Date.now(),{stopDistance:s,mode:i}=n||{};i??=$e;let x=i==xt?.3:.1,p=pt(t.pos,e)/x,l=e[0]-t.pos[0];l!=0&&i==$e&&(t.right=l>0);let v=lt(e,o);return()=>{let re=Date.now(),ie=Math.min(re-r,p);t.pos=y(o,v,p?ie/p:1);let ae=ie>=p||pt(t.pos,e)<(s??0);return t.transform=ae?"":`rotateZ(${i==xt?-10:i==jt?10:Math.sin(re/100)*5}deg)`,!ae}}function bn(t){return t.right?1:-1}function H(t,e,n=0){let o=h(t.pos),r=h(e);return r==o?[()=>O(t,e,{stopDistance:n})]:[()=>O(t,G(o)),()=>t.pos=y(G(r),[5,0,0]),()=>O(t,e,{stopDistance:n})]}function Gt(t){let e=Date.now();return()=>Date.now()<e+t}function Ae(t){return[()=>O(t,y(t.combat.pos,[bn(t)*-20,0,0]),{mode:jt}),()=>O(t,t.combat.pos,{mode:jt})]}function De(t,e,n=()=>{}){return[()=>O(t,e.combat.pos,{mode:xt}),()=>{Le(t,e),n()},()=>O(t,t.combat.pos,{mode:xt}),()=>{t.combat.delay=Nt(t),Q(h(t.pos))}]}function gt(t){return[t.size[0]*t.scale,t.size[1]*t.scale]}function et(t){!t||(ht(t),C(t))}function C(t,e){if(!t)return;if(!t.animation&&t.actionsQueue){let s=t.actionsQueue.shift();if(s){let i=s();i instanceof Function&&(t.animation=i)}}t.animation&&t.animation()==!1&&delete t.animation;let n=t.div,o=e?y(t.pos,e):t.pos,r=lt(o,yn(t));n.style.opacity=t.opacity,n.classList.toggle("current",t==a),n.classList.add("k"+t.kind),n.classList.toggle("right",t.right),It(n,r,(t.right?dn:"")+(t.transform??""))}function yn(t){return[gt(t)[0]/2,0,gt(t)[1]]}function Kt(t){let e=Rt(1),n=document.createElement("div");return n.classList.add("entity"),n.appendChild(e),n.style.position="absolute",e.id="s"+t.id,t.canvas=e,t.div=n,t.kind==1&&(t.title=document.createElement("div"),t.title.classList.add("etitle"),n.appendChild(t.title)),ht(t),e}function xn(t){return t&&[t.shape,t.colors]}function ht(t){t.material&&(t.colors=L[t.material].colors),t.makeBits&&(t.bits=t.makeBits(t));let e=t.canvas,n=1;if(e.width=t.size[0]*n,e.height=t.size[1]*n,e.style.transformOrigin=t.origin,e.style.transform=`scale(${t.scale})`,f(e).imageSmoothingEnabled=!1,t.bits)for(let o=0;t.bits[o];o++){let r=t.bits[o];if(!r||!r[0])continue;let s=I(r[1],r[0]);f(e).drawImage(s,t.bitPos[o][0]*n,t.bitPos[o][1]*n,s.width*n,s.height*n)}}function b(t){t.id??=be(),t.held=[];let e={canvas:Kt(t),floor:0,actionsQueue:[],...t},n=ce[e.type];if(n&&(n.placeh&&(e.mountPoint??=[5,0,9-n.placeh*8]),e.shape??=[0,16,80,0,0][e.kind]+n.ind,e.scale??=n.scale),e.scale??=1,ht(e),e.pos&&(g[t.id]=e,Scene.appendChild(e.div),t.className&&e.div.classList.add(t.className),C(e)),!e.aspects)for(let o of[L[e.material],mt[e.type],$[e.type]])e.aspects=Ct(e.aspects,o?.aspects);return e}function B(t){t.div.parentElement?.removeChild(t.div),delete g[t.id]}function V(t,e,n){e.kind==2&&(t.div.appendChild(e.div),t.held.unshift(e),e.parent=t,e.pos=n??se(t.mountPoint,t.scale),C(e))}function Wt(t,e){let n=t.held.shift();return n&&(n.pos=e??t.pos,Scene.appendChild(n.div),delete n.parent,C(n)),n}function h(t){return~~(t[0]/u)+d*~~(t[2]/c-1)}function Ft(t){return[t%d*u,0,c*~~(t/d+1)]}function G(t){return y(Ft(t),[u/2,0,0])}function nt(t,e){return{...D,shape:t,colors:e}}function Me(t,e){e&&(t.colors=e.colors,t.shape=e.shape,t.scale=e.scale),ht(t)}function P(t,e=!0){return e?Ne(rt(t).pos):rt(t).pos}function rt(t){return t.parent?rt(t.parent):t}function at(t){let e=h(P(t));return S[e].dream}function K(t){return Object.values(g).filter(e=>h(P(e))==t)}function qt(t,e){if(!e)return;if(t.kind!=1)debugger;let n=E[e];return b({...D,shape:dt+n.ind,colors:n.colors,pos:y(t.pos,[0,0,-30]),className:"thought",deadAt:Date.now()+3e3})}function Qt(t){return t.level??Pt(t.aspects)}function Vt(t){if(!t||!Jt(t))return;let e="",n="";return t.kind==1?e=`${t.name} the ${t.type||"X"}`:e=`${t.material||""} ${t.type}`,n+=`Level ${Qt(t)}<br/><br/>`,t.aspects&&(n+=me(t.aspects)),[e,n]}function gn(t){let e=K(h(t.pos)),n=ct(e.map(o=>{if(o==t||!Jt(o))return 0;let r=pt(t.pos,P(o));return Qt(o)/(10+r)*He(t,o)}));return e[n]}function hn(t,e){let n=F(e.aspects),o=Qt(e)*He(t,e)*.01;o=pe(o),o&&(t.aspects=Ct({[n]:o},t.aspects),t.recent.unshift(e.id),t.recent.length=20,t==_t&&st(t),qt(t,n))}function He(t,e){t.recent??=[];let n=t.recent.indexOf(e.id);return n==-1&&(n=1e6),1-1/(1+n)}function Re(t){if(!En(t))return;let e=gn(t);!e||A(t,[...H(t,P(e),5),()=>hn(t,e),()=>Gt(1e3)])}function En(t){return!t.actionsQueue?.length&&!t.animation}function Ie(t){let e=Pt(t.aspects);if(t.level<e){let n=F(t.aspects);t.aspects[n]=Math.max(0,t.aspects[n]-.01*~~(e-t.level+1))}}function Xe(t){return S[h(P(t))].dream}function A(t,e){!t||(t.actionsQueue=e,delete t.animation)}function Yt(t,e=void 0){return K(t).filter(n=>n.kind==1&&(e===void 0||!n.dream==!e))}function ot(t,e){return t.aspects[e]??0}function Bt(t,e){t.title&&(t.title.innerHTML=e)}function Zt(t){Bt(t,`${t.combat?.hp}/${Ot(t)} hp`)}function ke(){return F(mt,t=>t.chance)}function Oe(t,e){e.type=="Bed"&&yt(t)}var Ut=[],Et=[-100,20],Ye=600;function Ne(t){return[t[0],t[1],Math.ceil(t[2]/c)*c]}function Fe(t,e){Me(k,t),k.pos=e,Scene.appendChild(k.div),C(k)}function te(){Scene.style.left=`${Et[0]}px`,Scene.style.top=`${Et[1]}px`}function Be(){onpointerup=t=>{Ut[t.button]=!1},onpointerdown=t=>{Ut[t.button]=!0;let[e,n,o,r]=vt(t),s=[e,n,r*c],i;if(a&&o=="f"&&!t.shiftKey&&((t.button==2||t.button==0&&!a.held.length)&&(i=H(a,s)),t.button==0&&a.held.length&&(i=[...H(a,s),()=>Wt(a)])),a&&o=="s"&&!t.shiftKey){let p=g[r];p&&p!=a&&!at(p)&&(t.button==2&&(i=[...H(a,P(p),15),()=>Oe(a,p)]),t.button==0&&(p.kind==1?_(rt(p)):i=[...H(a,P(p)),()=>{if(a.held.length){let l=Wt(a);l&&V(p,l)}else V(a,p)}]))}i&&!at(a)&&A(a,[...i,()=>Gt(5e3)]),oncontextmenu=p=>{p.shiftKey||p.preventDefault()},t.target.classList.contains("sprite")},onmousemove=t=>{if(Ut[1]){let p=.5;Et=y(Et,[t.movementX,t.movementY],p),te()}let[e,n,o,r]=vt(t),s=[e,n,r*c],i=a?.held[0],x=g[r];if(st(x),i&&(o=="f"&&Fe(i,s),o=="s"&&x&&x.kind==2)){let p=y(x.pos,[0,0,-gt(x)[1]*.7]);Fe(i,p),x.div.parentElement?.appendChild(k.div)}t.preventDefault()},onwheel=t=>{Ye-=t.deltaY*.2,ee()}}var _t;function Jt(t){return t.kind==2||t.kind==1}function st(t){let e=Vt(t)||Vt(a);_t=t||a,Info.innerHTML=e?`<h1>${e[0]}</h1>${e[1]}`:""}function ee(){Scene.style.transform=`translateZ(${Ye}px)`}function vt(t){let[e,n,o]=[t.target.id,t.offsetX,t.offsetY],r=e[0],s=e.substring(1);return[n,o,r,s]}function ne(t){return[...t.matchAll(/(\w)(\w)(\w)/g)].map(e=>[...e.slice(1,4).map(n=>~~(Number.parseInt(n,36)/36*100)/100),1])}var Ze="906j05u58zdczpdrfag867240125869i8lp8zu7zi8t94h34724i97wlfzuozzvqrrfjj68a13509d4kngtqzvuzjnq8kd3duzzxxx";var Ke="1",We="2",qe=0;function vn(t){for(let e in t){let n=R(t[e]);console.log(`%c          %c ${Number(e).toString(36)} ${n}`,`color:#00; background:${n}`,"background:#fff")}for(let e in L){let[n,o]=[...L[e].colors].map(r=>w[Number.parseInt(r,36)]);console.log(`%c   %c %c ${e}`,`color:#00; background:${R(n)}`,`color:#00; background:${R(o)}`,"background:#fff")}for(let e of Object.values(E)){let[n,o]=[...e.colors].map(r=>w[Number.parseInt(r,36)]);console.log(`%c   %c %c ${e.name}`,`color:#00; background:${R(n)}`,`color:#00; background:${R(o)}`,"background:#fff")}}function Sn(){for(let t in w){let e=R(w[t]),n=Number(t).toString(36);Debug.innerHTML+=`<div class=csel id="C${n}" style="background:${e}" oncontextmenu="return false;" >${n}</div>`}}function Tn(){vn(w),Sn();for(let t=0;t<256;t++)Debug.appendChild(I(0,t))}addEventListener("pointerdown",t=>{let[e,n,o,r]=vt(t);if(o=="f"&&t.button==0&&t.shiftKey){let i=Ge();i.pos=[e,n,r*c],C(i)}o=="O"&&(qe=r),o=="C"&&(t.button==0?Ke=r:We=r),Preview.innerHTML="";let s=Ge();Preview.appendChild(s.canvas)});var je="ayhiadream",ze=0;addEventListener("keydown",t=>{if(t.code=="KeyD"&&Debug.classList.toggle("dn"),t.code=="KeyS"){let e=fe();localStorage.setItem(je,JSON.stringify(e))}if(t.code=="KeyL"){let e=localStorage.getItem(je);e&&de(JSON.parse(e))}if(t.code=="KeyT"){let e=K(h(a.pos)),n=N(e);A(a,H(a,P(n),15))}if(t.code=="KeyE"){let e=Object.keys(E)[ze];qt(a,e),ze++}t.code=="KeyN"&&(at(a)?Xt(h(a.pos)):yt(a))});function Ge(){return b({...D,shape:qe,colors:Ke+We,pos:[0,0,0]})}function Qe(){console.log(E),console.log(L),console.log($),Tn()}function Ve(){let t="";Scene.innerHTML+=t;for(let l of[Back,Front])j(l,u*d,c*Y,2);Front.style.transform=`translateZ(${T}px)`,U(Back,X(Z("2f",1)));let e=f(Front);e.fillStyle=X(Z("2g",1));for(let l=0;l<d;l++)e.fillRect(l*u*2-10,0,20,1e4);for(let l=0;l<Y;l++)e.fillRect(0,l*c*2-10,1e4,20);let n=X(Z("gf",2)),o=X(Z("rq",1));for(let l=0;l<=d;l++){let v=tt(`w${l}`,"wall",{left:`${l*u}px`});j(v,T,c*Y,2),U(v,n)}for(let l=0;l<=Y;l++){let v=tt(`f${l}`,"floor",{top:`${l*c}px`});j(v,u*d,T,2),U(v,o)}for(let l=0;l<At;l++)b({...it,shape:80,colors:"ef",type:"Door",level:l,scale:2,pos:G(l)});let r=Te(0),s=X(Z("ba",9));U(r,s);let i=Pe(ge("45",11),16);f(r).fillStyle=X(i),f(r).globalAlpha=.5,f(r).fillRect(0,0,r.width,r.height),r=Ce(0);let x=I("57",Ht),p=I("a9",Ht+2);f(r).fillStyle=s,f(r).fillRect(0,r.height*.8,r.width,r.height*.2);for(let l=0;l<5;l++){let v=m(20);bt(r,x,16+l*100,166-v,8),bt(r,p,16+l*100,130-v,8)}}var w=ne(Ze),$t=new Set,vr,_e,Cn,k,Ue,a,g={};onload=()=>{img.onload=Pn,img.src="16cols.gif"};function _(t){if(!t)return;let e=a;a=t,et(e),et(a),a.div.appendChild(Ue.div)}function Pn(){Ve(),ee(),Be(),te(),_e=b({...z,level:1,shape:18,colors:"nm",type:"Cat",name:W(),chest:nt(J+2,"lk"),pos:[20,10,c]}),Cn=b({...z,level:1,shape:26,colors:"qp",type:"Dog",name:W(),chest:nt(J+1,"ba"),pos:[40,10,c]}),k=b({...D,opacity:.5,shape:1,colors:"ab",pos:[0,0,0],noclick:!0}),k.canvas.classList.add("phantom");for(let t=0;t<30;t++){let e=$[F($,n=>n.chance)];b({...zt,kind:2,type:e.name,material:m(2)?N(Object.keys(L)):e.material,pos:[m(d)*u+10+m(u-20),m(T),c]})}Ue=b({...D,shape:8,colors:"ab",pos:[8,0,4],className:"pointer"}),_(_e),tn(0),st(),Qe()}var Je=0,oe=0;function tn(t){let e=t-Je||1;Je=t;let n=Date.now();oe=oe*.9+1e3/e*.1,FPS.innerText=`FPS: ${~~oe}`,Object.values(g).forEach(o=>{(o.actionsQueue.length||o.animation)&&C(o),o.deadAt&&n>o.deadAt&&B(o),o.kind==1&&(Xe(o)||e>m()*3e3&&(Ie(o),Re(o))),document.querySelectorAll(".aspect").forEach(r=>{let s=E[r?.dataset?.aspect];if(!s)return;delete r?.dataset?.aspect;let i=Kt({...D,shape:dt+s.ind,colors:s.colors});r.prepend(i)})}),requestAnimationFrame(tn),a?.held.length||(k.div.style.opacity="0")}})();
//# sourceMappingURL=bundle.js.map
