<style>
  body {
    background-color: #000;
    overflow: hidden;
    font-family: Georgia;
    user-select: none;
    background: linear-gradient(#008, #000);
    overflow: hidden;
  }

  #BG {
    position: fixed;
    filter: url(#_N);
    width: 100vw;
    height: 100vh;
    opacity: 0.3;
  }

  .stats {
    display: grid;
    white-space: nowrap;
    grid-template-columns: auto auto auto auto;
  }

  .grid3 {
    display: grid;
    white-space: nowrap;
    grid-template-columns: auto auto auto;
  }


  u {
    cursor: pointer;
  }

  #Saves {
    position: fixed;
    right: 10px;
    color: #fff;
    text-align: right;
  }

  .saves {
    display: grid;
    grid-template-columns: auto auto auto auto;
    gap: 10px;
  }

  .saves>button {
    cursor: pointer;
  }

  canvas,
  .entity {
    padding: 0;
    margin: 0;
    position: relative;
    transform-origin: 0% 0%;
  }


  .entity.k4,
  .entity.current {
    pointer-events: none;
  }

  .pointer {
    animation: .5s blink infinite alternate-reverse;
  }

  .sprite {
    image-rendering: pixelated;
    padding: 0;
    margin: 0;
  }

  .sprite:hover {
    filter: brightness(1.2);
  }

  #Back {
    z-index: -100;
  }

  .wall,
  .floor {
    pointer-events: all;
  }

  .carpet {
    pointer-events: none;
  }

  .floor,
  .carpet,
  .wall,
  .wp,
  .curtain,
  #Back {
    position: absolute;
    transform-origin: 0% 0%;
  }

  .curtain {
    pointer-events: none;
    transform: translateZ(64px);
  }

  .wall {
    transform: rotate3d(0, -1, 0, 90deg);
  }

  .wp {
    background-color: #008;
  }


  .floor,
  .carpet {
    transform: rotate3d(1, 0, 0, 89.9deg);
  }

  #Cam {
    perspective: 800px;
    perspective-origin: 50% 200%;
    position: absolute;
    top: 0;
    left: 50vw;
  }

  #Scene {
    position: absolute;
    transform-style: preserve-3d;
  }

  #Preview {
    padding: 20px;
    pointer-events: none;
  }

  /*
  #Debug {
    position: absolute;
    left: 0;
    top: 0;
    width: 350px;
    z-index: 10;
    font-size: 18px;
    color: #fff;
  }

  #Debug .csel {
    padding: 10px;
    display: inline-block;
    color: #fff;
    text-shadow: 1px 1px 1px #000;
  }

  #Debug .csel * {
    pointer-events: none;
  }

  #Debug .sprite {
    transform: scale(2);
    margin: 10px;
  }
*/

  @keyframes blind {

    0%,
    100% {
      filter: opacity(0);
    }

    20% {
      filter: opacity(1);
    }
  }

  @keyframes blink {
    0% {
      filter: brightness(0.8);
    }

    100% {
      filter: brightness(1.2)
    }
  }

  @keyframes rotate {
    0% {
      transform: rotate(-10deg);
    }

    100% {
      transform: rotate(10deg);
    }
  }

  .thought {
    z-index: 100;
    animation: 3s flow-up forwards linear;
  }

  .thoughtd {
    z-index: 100;
    animation: 3s flow-down forwards linear;
  }


  .aspect {
    font-size: 20;
  }

  .aspect canvas {
    padding-right: 10px;
    transform: scale(2) translateY(4px);
    transform-origin: 50% 80%;
  }

  .num {
    min-width: 50px;
  }

  @keyframes flow-up {

    0%,
    100% {
      opacity: 0;
    }


    100% {
      transform: translateY(-10px);
    }

    20% {
      opacity: 1;
    }
  }

  @keyframes flow-down {

    0%,
    100% {
      opacity: 0;
    }

    0% {
      transform: translateY(10px);
    }

    20% {
      opacity: 1;
    }
  }

  .ftext {
    position: absolute;
    font-size: 5px;
    text-align: center;
    color: #fff;
    text-shadow: 1px 1px 1px #000;
    pointer-events: none;
  }

  .ftext div {
    animation: 3s flow-up forwards linear;
  }

  .etitle {
    color: #fff;
    pointer-events: none;

    position: absolute;
    top: -3px;
    z-index: 100;
    left: 0;
    font-size: 4px;
    width: 100%;
    text-align: center;
    white-space: nowrap;
  }

  /*.right {
    transform: scaleX(-1) translateX(16px);
  }*/

  .right .etitle {
    transform: scaleX(-1)
  }

  .right>canvas {
    transform-origin: 100% 0%;
  }


  .etitle,
  .red,
  .grn {
    text-shadow: .2px .2px .2px #000;
  }

  .red {
    color: #f88;
  }

  .grn {
    color: #8f8;
  }


  .blink {
    animation: blink infinite alternate .5s;
  }

  .blind {
    pointer-events: none;
    position: absolute;
    animation: blind 4s;
  }

  .dn {
    display: none;
  }

  i {
    font-size: 80%;
    opacity: 70%;
  }

  .lvl {
    display: inline-block ;
    min-width: 40px;
  }

  #Msg {
    position: fixed;
    left: 50%;
    top: 50%;
    width: 400px;
    transform: translate(-200px, -200px);
    z-index: 100;
    text-align: center;
    color: #fff;
    display: none;
  }


  #Info {
    position: fixed;
    top: 10px;
    left: 10px;
    color: #fff;
    max-width: 350px;
    font-size: 15px;
  }

  #Info,
  #MSg,
  .saves {
    padding: 0px 20px 20px 20px;
    background: #0003;
    border-radius: 4px;
    border-right: solid 1px #fff4;
    border-top: solid 1px #fff4;
  }

  .roomn {
    font-size: 10px;
    white-space: nowrap;
    transform: translateX(30px);
  }
</style>

<div class=dn>
  <svg>
    <defs id="DEFS">
      <filter id=_N>
        <feTurbulence baseFrequency=0.005 type="fractalNoise" numOctaves="4" />
      </filter>
      <filter id=_S>
        <feColorMatrix type=matrix values="1 0 0 0 0  -1 0 0 0 1  0 0 0 0 0  0 0 0 0 1" />
      </filter>
      <filter id=_T>
        <feColorMatrix type=matrix values="1 0 0 0 0  -1 0 0 0 1  0 0 0 0 0  1 0 0 0 0" />
      </filter>
      <filter id=_O>
        <feColorMatrix type=matrix values="1 0 0 0 0  0 0 0 0 0  0 0 0 0 0  1 0 0 0 0" result=f />
        <feMorphology operator=dilate radius=".9" />
        <feColorMatrix type=matrix values="0 0 0 0 0  1 0 0 0 0  0 0 0 0 0  1 0 0 0 0" />
        <feBlend in2=f mode=overlay />
      </filter>
      <filter id=_4>
        <feColorMatrix type=matrix values="1 0 0 0 0  1 0 0 0 0  1 0 0 0 0  0 0 0 1 0" />
      </filter>
    </defs>

  </svg>

  <canvas id=TC></canvas>

  <img id=img src="" />
</div>

<!--<div id=BG></div>-->

<div id=Debug class=dn>
  <div id=Preview></div>
  <div id=FPS></div>
</div>

<div id=Cam>
  <div id=Scene>
    <canvas id=Back></canvas>
  </div>
</div>

<div id=Saves></div>

<div id=Info></div>

<div id=Msg></div>


<script src=bundle.js></script>